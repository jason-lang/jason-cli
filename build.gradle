/*
   Jason Gradle build file
*/

plugins {
//   id "ca.coglinc.javacc" version "2.4.0"
  // see https://github.com/johnmartel/javaccPlugin
}

defaultTasks 'build'

apply plugin: 'java-library'
// apply plugin: 'maven-publish'

version '1.0-SNAPSHOT'
group   'org.jason'

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

sourceSets {
    main {
        java {
            srcDir 'src/main/java'
        }
        resources {
            srcDir 'src/resources'
        }
    }
}

repositories {
    mavenCentral()

    maven { url "https://raw.githubusercontent.com/jacamo-lang/mvn-repo/master" }
    maven { url 'https://repo.gradle.org/gradle/libs-releases' }
}

dependencies {
    implementation 'org.jason:jason:3.2-SNAPSHOT'
    implementation 'info.picocli:picocli:4.7.1'
    // implementation('org.apache.ant:ant:1.10.5')
    // implementation('org.gradle:gradle-tooling-api:7.4.2')

    testImplementation group: 'junit', name: 'junit', version: '4.12'
}

// copy dep jars and scritps into build directory
task copyJarsToBuild {
    inputs.files configurations.runtimeClasspath.files
    inputs.dir   'src/main/resources/scripts'
    outputs.dir  'build/libs'
    outputs.dir  'build/scripts'
    doLast {
        copy {
            from configurations.runtimeClasspath
            into 'build/libs'
        }
        copy {
            from 'src/main/resources/scripts'
            into 'build/scripts'
            include '**'
        }
    }
}

jar {
    archiveBaseName = 'jason-cli'
    manifest {
        attributes 'Main-Class': 'jason.util.ConfigGUI',
                   'Specification-Title': 'Jason CLI',
                   'Specification-Version': project.version,
                   'Implementation-Version': new Date().toString()
    }

}
jar.dependsOn(copyJarsToBuild)

